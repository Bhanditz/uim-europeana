<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

	<bean id="uimRegistry" class="eu.europeana.uim.UIMRegistry">
		<property name="orchestrator" ref="uimOrchestrator"/>
	</bean>

	<bean id="uimOrchestrator" class="eu.europeana.uim.orchestration.UIMOrchestrator">
		<property name="registry" ref="uimRegistry"/>
	</bean>

	<command-bundle xmlns="http://felix.apache.org/karaf/xmlns/shell/v1.0.0">
		<command name="uim/info">
			<action class="eu.europeana.uim.UIMInfo"/>
		</command>
	</command-bundle>
	
	<reference-list interface="eu.europeana.uim.plugin.IngestionPlugin" availability="optional">
		<reference-listener 
              bind-method="addPlugin" unbind-method="removePlugin" ref="uimRegistry">
      	</reference-listener>
	</reference-list>
	
	<reference-list interface="eu.europeana.uim.store.StorageEngine" availability="optional">
		<reference-listener 
              bind-method="addStorage" unbind-method="removeStorage" ref="uimRegistry">
      	</reference-listener>
	</reference-list>


    <bean id="memoryStore" class="eu.europeana.uim.store.memory.MemoryStorageEngine"/>
	<service id="fallbackStorage" ref="memoryStore" interface="eu.europeana.uim.store.StorageEngine"/>
	
</blueprint>
